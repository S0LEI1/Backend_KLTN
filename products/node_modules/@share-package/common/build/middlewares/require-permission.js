"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.requirePermission = void 0;
const bad_request_error_1 = require("../errors/bad-request-error");
const requirePermission = (permission) => {
    return (req, res, next) => {
        const permissions = req.currentUser.permissions;
        if (!permissions.includes(permission))
            throw new bad_request_error_1.BadRequestError(`Required: ${permission} permission`);
        next();
    };
};
exports.requirePermission = requirePermission;
